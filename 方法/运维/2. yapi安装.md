3、部署Yapi-cli

1）设置镜像源
npm install -g yapi-cli --registry https://registry.npm.taobao.org

2）运行Yapi部署工具
yapi server

注意：
（1）安装成功会有以下提示：在浏览器打开http://0.0.0.0:9090访问。。。。。。
（2）外网无法访问时请确认服务器是否已经开放了端口

3）访问部署工具站点

4）填写相应信息开始部署

5）修改配置
按CTRL+C

输入 vim /root/my-yapi/config.json

{
  "port": "3000", //外网访问端口
  "adminAccount": "yizitadmin@yizit.cn", //管理员邮箱
  "db": {
       "servername": "127.0.0.1",
       "DATABASE": "yapi",
       "port": "27017"
   },
  "mail": {
       "enable": true,
       "host": "smtp.163.com",
       "port": 465,
       "from": "可用于发送邮件的163邮箱",
       "auth": {
           "user": "163邮箱",
           "pass": "163邮箱对应的密码或授权码"
       }
  }
} 

6）启动服务
#切换到部署目录下
cd /root/my-yapi

#启动服务
node vendors/server/app.js


7、多站点创建nginx的conf文件
执行sudo vi /etc/nginx/nginx.conf打开nginx默认配置文件，
在http{ }中查看是否有include /etc/nginx/conf.d/*conf；
如果没有，在http{}末尾进行添加并进行保存，然后退出编辑

注：此处conf.d为多站点conf文件存放目录

执行vim /etc/nginx/conf.d/配置文件名.conf  （建议采用域名作为配置文件名）

添加一下文本段

server {
    listen 80; 外网端口
    server_name a.com;绑定网站对应域名
 
    location / {
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   Host      $http_host;
        proxy_pass         http://127.0.0.1:8082;本地网站地址
    }
}

保存退出

注：yapi在location /添加
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection "upgrade";