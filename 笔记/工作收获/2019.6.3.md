### 简介

- 公司：北京智雨物联科技有限公司
- 需求：调用打印特定区域（就是特定标签内）的内容，例如打印 body下面 id为 con 标签里面的内容

---

### 解决过程

- 第一步：首先是找了原生的方法，但是有 css 样式打印不出来的问题
- 第二步：寻找第三方库，找到一个叫做 print-js的库，但是可惜，在 vue-cli3.0 下，打包出的css都散成一块块的，于是样式也是打印不出来（但是自己试验的样式可以显示出来，整体来说比第一步有了提升）
- 第三步：将区域内容转为 图片，采用 html2canvas 这个库，实际结果可行（图片有部分偏差但是不影响）

```javascript

// html2canvas已经挂到了window上

function dowClick() { // 下载按钮点击触发

    html2canvas(document.querySelector("#downloadImgMain"), {
        allowTaint: true, //允许污染
        taintTest: true, //在渲染前测试图片(没整明白有啥用)
        useCORS: true, //使用跨域(当allowTaint为true时这段代码没什么用)

    }).then(canvas => {
        // 下载
        let type = 'png';   //设置下载图片的格式
        let img_png_src = canvas.toDataURL("image/png");  //将canvas保存为图片
        let imgData = img_png_src.replace(imgType(type),'image/octet-stream');
        let filename = '图片' + '.' + type; //下载图片的文件名
        saveFile(imgData, filename);
    });
}

function imgType (ty) {
  let type = ty.toLowerCase().replace(/jpg/i, 'jpeg');
  let r = type.match(/png|jpeg|bmp|gif/)[0];
  return 'image/' + r;
}

function saveFile (data, fileName) {
  let save_link = document.createElement('a');
  save_link.href = data;
  save_link.download = fileName;
  let event = document.createEvent('MouseEvents');
  event.initEvent("click", true, false);
  save_link.dispatchEvent(event);
};
```